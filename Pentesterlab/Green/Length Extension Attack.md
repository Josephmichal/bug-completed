## Introduction
-->This exercise covers how to use a length extension attack to exploit a directory traversal vulnerability
-->This course details the exploitation of a weakness in the way the applications "sign" information.
-->The website uses hashing to hash a secret with a value in order to make sure the value has not been tampered with.
-->Unfortunately, the way the hashing is performed allows an attacker to perform a length extension attack.
-->This issue was one of the challenges in the Stripe CTF and the [Wikipedia page on the attack](https://en.wikipedia.org/wiki/Length_extension_attack) is actually based on the challenge.

## Length Extension
-->Length extension comes from the way a developer may use a hash function that is not resistant to length extension.
-->If a developer does something like:
```
HASH([SECRET][DATA])
```
Where:
-   [SECRET] is the secret used to protect the signature.
-   [DATA] is the string being signed.
-->It's possible for an attacker to compute:
```
HASH([SECRET][DATA][PADDING][SUFFIX])
```
Where:
-   [SECRET] is the secret used to protect the signature.
-   [DATA] is the string being signed.
-   [PADDING] is the padding of the HASH function
-   [SUFFIX] is an arbitrary suffix chosen by the attacker.
-->This can, for example, be used in a directory traversal like in this challenge:
```
HASH(secretmyfile.rb[PADDING]/../anotherfile)
```
Where:
-   secret is a secret
-   file.rb is the signed value
-   [PADDING] is the padding of the HASH function
-   /../anotherfile is the suffix picked by the attacker
-->The only thing the attacker needs to know is the size of the secret [SECRET] and the [DATA], to be able to compute the [PADDING].
-->If you don't know the length of the [SECRET], you can just bruteforce the value.

## Exploitation
-->To perform this attack, you can write your own tool or use [hash\_extender](https://github.com/iagox86/hash_extender).
-->The README for hash\_extender is worth reading for the details on the attack and the details on how to write your own tool in C.

## Conclusion
-->This exercise showed you how you can extend a hash in order to bypass a signed value.
-->That's why HMAC should always be preferred to a simple hash to sign information.f