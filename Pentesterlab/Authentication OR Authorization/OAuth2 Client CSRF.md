## Introduction
-->This course details the exploitation of an insecure OAuth2 Client that is vulnerable to CSRF because it does not use the state in the OAuth2 dance. This client uses OAuth2 as a pseudo-authentication mechanism and in this challenge, you will see how you can use the CSRF issue to bypass the authentication.
-->OAuth2 is incredibly hard to get right that's why being able to find holes in implementations is so important.

## The vulnerability
-->This vulnerability here is a simple Cross-Site Request Forgery vulnerability in the OAuth2 Client. OAuth2 Clients use a parameter named stated to ensure that the request when the User-Agent gets redirected to the OAuth2 Client from the Authorization Server comes from the OAuth2 Client and was started for the current user.
-->In this application, the OAuth2 Client doesn't use a state parameter and we can use this behaviour to get the victim to link their account on the OAuth2 Client to an account we control.

## Exploitation
-->To exploit this vulnerability, you will need to register a malicious account on the Authorization Server. From there we will start the OAuth2 dance on the OAuth2 Client (by signing up with OAuth2 as the flows to link and login are the same). We will need to stop the request that redirects the User-Agent to the OAuth2 Client. We can then use this request to CSRF the victim and get the victim to link their account to the malicious account we created. Once this is done. We can now be authenticated on the OAuth2 Client website using OAuth2. Since our malicious account is linked to the victim account's on the OAuth2 Client, we will get access to the victim's information on the OAuth2 Client website (and the key for this exercise).

## Conclusion
-->This exercise showed you how to exploit a vulnerability in an OAuth2 implementation impacting the OAuth2 Client. With more and more enterprises using OAuth2, it's important to ensure that this kind of mistakes gets detected and fixed before they get exploited.

# Video Explanation
## Video 1 introduction
- Start the oauth2 flow in your browser
- Stop before the redirect to the oauth2 client
- Get the victim to visit the link
- The victim's account is linked
- Get access to the key for this exercise by logging in as the victim on the Oauth2 client via "Login with OAuth2"
-->ithupoloru lab namal portswigger il chythitund. redirect aakuna samayath request drop chyum.enit aa link victim in koduth victim aa link kerumbol victim inte oauth2 vazhi victim kerum pakshe account namude aanalo.atahyath namude account il oauth aakanam so aakuna vazhik namal request drop chyth aa url victim kodukumbol victim inte oauth namude account il save aakum ok