## Introduction
-->This course details the exploitation of an insecure OAuth2 Client that is vulnerable to CSRF because the link to logging with OAuth2 and to link an account are predictable. This client uses OAuth2 as a pseudo-authentication mechanism and in this challenge, you will see how you can use the CSRF issue to bypass the authentication.
-->OAuth2 is incredibly hard to get right that's why being able to find holes in implementations is so important.

## The vulnerability
-->This vulnerability here is a simple Cross-Site Request Forgery vulnerability in the OAuth2 Client. OAuth2 Clients should make sure that the link (or form) used to start the OAuth2 dance are not predictable. Combine with the fact that the Authorization Server is not protecting the login page from CSRF, it is possible to link the victim's account to your account and then use it to gain access to the victim's account.

## Exploitation
-->To exploit this vulnerability, you will need to register a malicious account on the Authorization Server and the OAuth2 Client. From there you can link both accounts together. This will ensure that the victim will not be prompted to allow the OAuth2 client when you will CSRF the victim. Then you will need to unlink the account (as an account can only be linked once).
-->For the payload, you will need to create an HTML page with an iframe. The iframe will be used to log the victim into your account on the Authorization server (since there is no CSRF protection). The main page will then (after a small delay), start the OAuth2 dance to link the victim's account on the OAuth2 Client to your account on the Authorization Server (since you logged the victim into this account using the iframe).
-->If the victim's account has already been linked to another account, it may be worth to CSRF-unlink the account before starting the OAuth2 dance.
-->Once you setup your webserver with the malicious page that automatically log the victim into your account (by using an auto-submitting form in an iframe) and starts the OAuth2 dance, you need to get the victim to visit your web server.
-->Finally, you will need to visit the OAUth2 Client and log in using OAuth2 to access the information from the victim.

## Conclusion
-->This exercise showed you how to exploit a vulnerability in an OAuth2 implementation impacting the OAuth2 Client. With more and more enterprises using OAuth2, it's important to ensure that this kind of mistakes gets detected and fixed before they get exploited.

# Video Explanation
## Video 1 introduction
- Register an account on the Authorisation Sever (namal use chyuna web app) and OAuth2 cient(like gmail)
- Link the account to authorize the OAuth2 Client. This will make sure that the victim doesnt get prompt to authorize the OAuth2 client
- Unlink the account. Bqz only one account can be linked at a time
- In one page(like iframe) : CSRF-login the victim in the Authorization Server and CSRF-starts the OAuth linking(if the victim already linked an account you may need to unlink the victims account first)
- Get access to the key for this exercise by logging in as the vcitim on the OAuth2 client via "Login with OAuth2"

## Video 2 exploitation
-->ivide iframe oke use chythal exploit chyunath.so ith chyenda karyamunden thonunila
-->pakshe ivide oAuth2 chyunathin mumb account ilek keruna normal login form intercept chythit athle csrf value remove chyth forward adikumbol namal login aakunund.so athinartham avidem csrf und ennan ok