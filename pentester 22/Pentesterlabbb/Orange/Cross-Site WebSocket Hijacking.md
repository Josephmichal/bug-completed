## Introduction
-->This course details the exploitation of a Cross-Site WebSocket Hijacking (CSWSH) vulnerability.
-->NOTE : The introduction of `SameSite` in browsers may limit the exploitation of this issue. The victim uses an old browser that does not enforce `SameSite=Lax`.
-->The course is based on the following article: [Cross-Site WebSocket Hijacking (CSWSH)](https://www.christian-schneider.net/CrossSiteWebSocketHijacking.html) and the following Bug Bounty Write-up ([Account Takeover Using Cross-Site WebSocket Hijacking (CSWSH)](https://medium.com/@sharan.panegav/account-takeover-using-cross-site-websocket-hijacking-cswh-99cf9cea6c50).

## Cross-Site WebSocket Hijacking
-->As opposed to XMLHttpRequest, WebSockets don't follow the same-origin policy.
```css
For example, a website hosted on Origin A can use a WebSocket to connect to Origin B (and read/write content from/to the websocket) by default.
```
-->As part of this connection, the users cookies of Origin B will be sent to Origin B.
-->This means that if the application relies on cookies to perform authentication/authorization, a malicious website can get a victim to access origin B via a WebSocket, and potentially access/modify sensitive data as this user.
-->To prevent this issue, the backend should check the `Origin` header to ensure that the `Origin` is part of a strict whitelist.

## Exploitation of the vulnerability
-->To exploit this issue, you will need to create a malicious HTML page that will connect to the backend and read/write information.
-->You can use the code of the vulnerable application to see how to use WebSockets.
-->This should allow you to connect to the backend. Once you get the socket to connect to the server, and you send the `/getkey` command, you will need to leak the information back to your server.
-->An easy way to do this is to create an `<img>` tag pointing back to your malicious server and embedding the leaked data as part of the URL.

## Conclusion
-->This exercise showed you a way to exploit a website that does not check the `Origin` when dealing with WebSocket.
-->This allowed you to communicate with the socket from a malicious website and gain access to sensitive information.

# Video Explanation
## Video 1 - CSWSH introduction
-->ivide authentication nn application cookies use chyunund. bu samsite policy applicaiton use chyunila.so athkond thane namuk matoru malicious website il ninum ithil ulla websocket ilek connect chyan patum ok. so angane ee real application il ulla admin namude malicious website use chyumbl /getkey enna path ilek pokumbol ath namude malicious website monitor chyum agnane namuk key kitum ok
-->ith njan chyunila.verutha aan.ingane samesite oke illatha applicaiton oke undon thane samshayam aan