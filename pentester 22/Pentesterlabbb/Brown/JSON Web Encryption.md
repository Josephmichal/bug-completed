## Introduction
-->This exercise covers how you can create your own JWE if you have access to the public key used by the server
-->This course details the exploitation of a weakness in some applications that rely on JSON Web Encryption (JWE).
-->In this application, JWE is used for authentication.
-->Upon successful login, the user is issued a JWE in a cookie.
-->The public key used by the application is also made available to users.
-->If you feel confident, you can try to do this exercise without following along with the course; then you can come back to the course to read some details and tips.

If you want to do it by yourself, you can follow the following steps:

-   Create one user.
-   Inspect the token.
-   Create your own token.

## JSON Web Encryption
-->JWE tokens are used to encrypt information in a token. Two keys are used:

-   A key to encrypt the body: the Content Encryption Key CEK.
-   A key to encrypt the Content Encryption Key.

-->The encryption of the body relies on Authenticated encryption to ensure the integrity of the cleartext (most commonly: AES-GCM).
-->To decrypt the body, an application will need access to the private key corresponding to the public key used to encrypt the Content Encryption Key.
-->JWE tokens follow this pattern:
```r
Base64(Header).Base64(Encrypt(CEK, public_key)).Base64(IV).Base64(Encrypt(Data, CEK)).Base64(authentication_tag)
```
Where:

-   Encrypt(CEK, public_key) is CEK encrypted using the public_key
-   Encrypt(Data, CEK) is the data encrypted using CEK

-->The header contains information on the security mechanisms used.
-->For example, the following header: eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkExOTJHQ00ifQ contains the following information:
```js
{"alg":"RSA-OAEP","enc":"A192GCM"}
```
Where:

-   alg is the algorithm used to encrypt the Content Encryption Key CEK
-   enc is the algorithm used to encrypt the data using the CEK

## The vulnerability
-->The issue here is a design issue.The integrity of the data is protected by the CEK.
-->An attacker cannot tamper with the data since he doesn't have access to the CEK.
-->However, since an attacker has access to the public key, it is possible for an attacker to forge tokens.
-->The only thing an attacker needs to guess is the content of the token.

## Exploitation
-->To exploit this vulnerability, you just need to create a token and encrypt with the public key.
-->To do so, you can use a JWE library in your favorite language.
-->The format of the payload is fairly simple and can be deducted from other JWT challenges.

## Conclusion
-->This exercise showed you how you can build your own JWE token if you have access to the public key, and gain administrator access in the application.
-->It showed you that having an encrypted value and integrity, does not always prevent an attacker from creating tokens.

# Video Explanation
## Video 1 introduction
-->ivide namal namuk kitiya jwt nokiyal kanam ivide moon parts alla pakaram 5 parts und ie, 4 dots ivide und
-->JWE consist of 5 parts ie, 
- JWE protector header
- JWE encrypted key (CEK)
- JWE Initialization vector
- JWE encrypted data
- JWE authentication tag
-->The attack :
- Login as any user and inspect the cookie you received
- Use the public key to sign a token with the username "admin"

## Video 2 exploitation
-->lab easy aanengilum kanumbo easy alla.ith njan chyunila