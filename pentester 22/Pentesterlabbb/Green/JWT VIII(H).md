## Introduction
-->This exercise covers how to use the jku header to bypass an authentication based on JWT.
-->Make sure you finish the following exercises before starting this one: [JWT II](http://pentesterlab.com/exercises/jwt_ii/), [CVE-2018-0114](https://pentesterlab.com/exercises/cve-2018-0114/) and [JWT III](https://pentesterlab.com/exercises/jwt_iii/).
-->In this exercise, we are going to cover the jku header in JWT tokens, specifically, we are going to forge a token to become admin.
-->The issue is very interesting, as JWT allows users to link to a public key (using the jku header) inside the header of the token.
-->However, the application should never trust this URL as an attacker can provide his own URL and sign the message using the corresponding private key.
-->The format we will need to follow to get the right JWK file is very similar to the challenge: [CVE-2018-0114](https://pentesterlab.com/exercises/cve-2018-0114/) and can be inferred from the URL in the token issued by the application ( or [https://www.pentesterlab.com/.well-known/jwks.json](https://www.pentesterlab.com/.well-known/jwks.json)).

## Building our exploit
-->If you finished the previous JWT exercises, you should already have multiple scripts to play with JWT tokens.
-->Here, we will need to do two things:
-   Build the header with the link to the site that you're hosting your JWK file.
-   Sign the token using RSA with the private key that matches the n and e in the JWK file.
-->First, you can create a private RSA key using openssl.
-->Once it's done, to keep things easier, you can build two scripts:
-   One to extract n and e from the private key you just created and populate your JWK file.
-   One to sign your payload using the same private key.
-->However, there are some pitfalls you may run into:
-   You need to change the n and e values in your hosted file (based on the example) to make sure they match the private key you're using.
-   The application caches the URL, so if you want to change the key, you need to change the URL.
-   You need to make sure the algorithm alg is the one you're using to sign. Most likely you will need to change the value to RS256.

## Conclusion
-->This exercise showed you how you can use the jku header to get the application to download a public key from a URL under your control, and how some vulnerable libraries may trust the key you're providing.
-->The most interesting property of this issue is that the developer of the application may not even use jku.
-->It showed you that even if the payload is signed, there may be a way to bypass the signature mechanism.

# Video Explanation
## Video 1 - introduction
-->As part of the jwt header, developers can add a "jku" header
-->The jwk set url "jku" is a url linking to a json web key
-->so jwk il ulla url attacker matum.angane attacker control chyuna url koduth attacke chyuna paripadi aan ok

## Video 2 - python3 exploitation(not completed)
-->lab open chyuka enit oru account aakuka.enit cookie nokiyal kanam ath oru jwt token aan
-->ini repeater il kond poi itt header part double click chyuka apol kanam header il jku paramter kidakunath :
```http
{"typ":"JWT","alg":"RS256","jku":"https://pentesterlab.com/.well-known/jwks.json"}
```
-->so ee jku ile url namal mati aan exploit chyunath
-->athin mumb ee url il namuk poi ithile contents edukam.so ->https://pentesterlab.com/.well-known/jwks.json url il pokuka :
```json
{
  "keys": [
    {
      "kty": "RSA",
      "use": "sig",
      "kid": "pentesterlab",
      "n": "oTtAXRgdJ6Pu0jr3hK3opCF5uqKWKbm4KkqIiDJSEsQ4PnAz14P_aJnfnsQwgchFGN95cfCO7euC8HjT-u5WHHDn08GQ7ot6Gq6j-fbwMdRWjLC74XqQ0JNDHRJoM4bbj4i8FaBdYKvKmnJ8eSeEjA0YrG8KuTOPbLsglADUubNw9kggRIvj6au88dnBJ9HeZ27QVVFaIllZpMITtocuPkOKd8bHzkZzKN4HJtM0hgzOjeyCfqZxh1V8LybliWDXYivUqmvrzchzwXTAQPJBBfYo9BO6D4Neui8rGbc49OBCnHLCWtPH7m7xp3cz-PbVnLhRczzsQE_3escvTF0FGw",
      "e": "AQAB",
      "alg": "RS256"
    }
  ]
}
```
-->so ithan avide ulla contents.so ith namuk avisam aan.but ithile n and e paramter namal mati vere vekanam. n ennath public key aanen thonunu
-->ithil iyal chyuna code oke entho valya code aan.enik aavula.oke bye