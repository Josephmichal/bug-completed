## Introduction
-->This course details the exploitation of an insecure SAML implementation that allows a malicious user to become another user by getting the Identity Provider (IDP) to create an assertion that will be parsed differently by the provider. This challenge was inspired by the following article [Duo Finds SAML Vulnerabilities Affecting Multiple Implementations](https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations).
-->This exercise is based on an alternative way to solve [SAML: Comment Injection](https://pentesterlab.com/exercises/saml_iii) discovered by Luca from [@MDSecLabs](https://twitter.com/MDSecLabs) when solving the challenge.

## The attack
-->One of the common issues with protocols relying on signatures to prevent tampering comes from the fact that the signed data is parsed differently by the system receiving it. Here we are going to create a malicious email address to become the user admin@libcurl.so for the service provider. The issue here is that the Service Provider will stripe XML comments and everything after the comments from the email address provided in the SAMLResponse by the IDP.
-->To exploit this issue, you will need to:
-   Register an account on the IDP that will end up as admin@libcurl.so once comments are stripped.
-   Login via SAML from the Service Provider.
-   Tamper with the SAMLResponse to add a comment that will remove everything after it.
-->The issue here is that the Service Provider will ignore the comment when verifying the signature and will remove the comment and everything after it when retrieving the NameID. This allows us to add a comment without invalidating the signature and be logged in as another user since everything after the comment gets removed.

## Conclusion
-->This exercise showed you how to exploit a vulnerability in a SAML implementation impacting the Service Provider. With more and more enterprises using SSO, it is essential to ensure that this kind of mistakes gets detected and fixed before they get exploited.

# Video Exploitation
## Video 1 introduction
-->The attack
- Register as a user like admin@libcurl.so.suffix on the IDP
- Start the SAML authentication
- Tamper with the SAML response to add the comment before the suffix

## Video 2 exploitation
-->ivide namuk admin@libcurl.so enna user aayi maranam. so athin namal suffix use chyunu like admin@libcurl.so.hack  enn suffix koodi add chyunu
-->ee exploit chyunath ruby scrip vechan.so ath njan pentesterlab il screenshot eduth vechitund
-->so aa script aaki save chythit namal saml response request il ninum edukanam.enit ee ruby script il vech chyumbol namuk puthiya saml response kitum.ath naaml namude saml response replace chyuka apol namal admin aayi marum ok