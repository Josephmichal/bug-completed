## Introduction
-->This course details the exploitation of an insecure OAuth2 Client that is vulnerable to an Open Redirect. The Open Redirect is a bit specific in the way it adds the parameters received to the final URL as parameters. This specificity makes the exploitation of the issue possible.

## The attack
-->One of the issues with OAuth2 can be found when the OAuth2 client is vulnerable to an Open Redirect. In this exercise, we will look into a simplified example since we will be able to retrieve the state and code via the Open Redirect (since they are reflected in the final URL).
-->If you have an Open Redirect, you will get the following behavior:

```
# 	Redirect type 	URL used to access the Open Redirect 	URL in the Redirect
>1 	Classic Redirect 	http://ptl.io/openredirect?url=http://pentesterlab.com 	http://pentesterlab.com
>2 	Classic Redirect 	http://ptl.io/openredirect?url=http://pentesterlab.com&state=12345&code=67890 	http://pentesterlab.com
>3 	Classic Redirect 	http://ptl.io/openredirect?url=http://pentesterlab.com%3Fstate=12345%26code=67890 	http://pentesterlab.com?state=12345&code=67890
>4 	Redirect with parameter reflection 	http://ptl.io/openredirect?url=http://pentesterlab.com?state=12345&code=67890 	http://pentesterlab.com
```

-->Here the application behaves like example 4. Since the redirect is initiated by the Authorization Server, we cannot use example 3 as we don't control the way the URL is built (and the authorization server will user ? and & without encoding them).
-->If an attacker can trick a victim into visiting a link to the Authorization Server with a malicious Redirect URL pointing to the Open Redirect on the OAuth2 Client. The attacker can get access to the OAuth2 code and pass the code to the OAuth2 Client to pretend the access was granted as the victim (as if it was the victim visiting the OAuth2 Client).
-->The attacker needs to follow these steps:

-   Start the OAuth2 "Dance" and intercept the request going to the Authorization using HTTP GET.
-   Setup a server where the attacker can access the logs.
-   Swap the redirect URL parameter with the OAuth2 Client Open Redirect pointing to the attacker's server.
-   Get the victim to visit this URL.
-   Use the request coming from the victim to finish the OAuth2 "Dance" with the OAuth2 Client (using the same session to keep the valid state).

-->By doing that, the attacker should have access to the resources via the OAuth2 Client. The resources contain the key and should be visible in the OAuth2 Client's page.

## Conclusion
-->This exercise showed you how to exploit a vulnerability in an OAuth2 implementation impacting the OAuth2 CLient. With more and more enterprises using OAuth2, it's important to ensure that this kind of mistakes gets detected and fixed before they get exploited.

# Video Explanation
## Video 1 introduction
-->The attack :
- Find the open redirect in the oauth2 Client website
- Start the oauth2 flow in your browser
- Tamper with the redirect_uri to point to the open redirect
- Get the victim to visit the link with your redirect_uri
- Get the code
- Continue the oauth2 flow by passing the code and original state to the oauth2 client
- Get access to the key for this exercise

## Video 2 exploitation
-->lab open chyuka.apol mukalil korach tab kanum athil hover chyumbol namuk kanan patum lab inte url thane aan ellathinum but end il oru redirect?url= enn koduth aa path kodukunud ie, ->http://ptl-8ac5a481-612853e5.libcurl.so/redirect?url=http://authorization-ptl-8ac5a481-612853e5.libcurl.so/
-->so ivide ee url mati https://google.com enn kodukumbol namuk open redirect kitunund
-->so ella path um main url il ninum thane thudangunathkond namal ini oauth2 sign in chyuka enit authrize prompt chodikuna page ethumbol athile url edukuka ie,
->http://authorization-ptl-8ac5a481-612853e5.libcurl.so/oauth/authorize?client_id=ed8dcb27c5dd3627375996a8cffdb97df35cfe770ccab11077bc94b140771b2f&redirect_uri=http%3A%2F%2Fptl-8ac5a481-612853e5.libcurl.so%2Fauth%2Fmyprovider%2Fcallback&response_type=code&state=114f7cef8e55633539f0ae87644da3e6abe70f69a330143d
-->so ivide nokiyal kanan patum ivide ulla redirect_uri parmter nok. athilum ulla value namude main url path thane aan.so namal enth venamenal namuek ee openredirection ulla url athil append chyuka ie, ipol redirect_uri=http%3A%2F%2Fptl-8ac5a481-612853e5.libcurl.so  ennanalo so athil namal ee open redirection url append chytha mathi ie open redirection il ulla /redirect?url=... ennath add chyuka. apol inagne varum ie,  redirect_uri=http%3A%2F%2Fptl-8ac5a481-612853e5.libcurl.so/redirect?url=  ini ee url il namal control chyuna webserver inte url/ip kodukanam.apol victim ee url use chyumbol namude webserver log il ath kanikumb athinte koode victim inte complete request um namuk kitum.aa request il code= um angaen namuk victim aayi maran venda ella kunthavum undakum.so angane namuk victim aayi maran patum ok